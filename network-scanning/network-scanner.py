from scapy.all import *

def arp_scan(interface, ip_range, timeout=2, inter=0.1):
    try:
        # Craft ARP request packet
        packet = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=ip_range)

        # Send and receive packets
        ans, _ = srp(packet, timeout=timeout, iface=interface, inter=inter)

        # Print results
        for send, receive in ans:
            print(f"MAC: {receive[Ether].src} - IP: {receive[ARP].psrc}")

    except Exception as e:
        print(f"An error occurred: {e}")

def main():
    interface = "Wi-Fi"
    ip_range = "192.168.2.2/24"

    print(f"Scanning IP range: {ip_range} on interface: {interface}")
    arp_scan(interface, ip_range)

if __name__ == "__main__":
    main()