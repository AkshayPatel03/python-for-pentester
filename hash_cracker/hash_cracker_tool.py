import hashlib
import pyfiglet

ascii_banner = pyfiglet.figlet_format("Python 4 Pentesters \n HASH CREATOR")
print(ascii_banner)

hash_input = input('Enter the clear text to create hash: ')
hash_algorithm = input('Enter Hash Algorithm name (e.g., sha256, md5, sha1): ')

# Check if the hash algorithm is supported
if hash_algorithm.lower() not in hashlib.algorithms_available:
    print("Error: Hash algorithm not supported.")
    exit(1)

# Get the hash function dynamically based on user input
hash_function = getattr(hashlib, hash_algorithm.lower())

# Calculate the hash
hash_obj = hash_function(hash_input.strip().encode())
hashed_value = str(hash_obj.hexdigest())

print('Hashed value: ' + hashed_value.strip())

wordlist_location = str(input('Enter wordlist file location: '))

# Flag to check if password is found
password_found = False

with open(wordlist_location, 'r') as file:
    for line in file.readlines():
        hash_ob = hash_function(line.strip().encode())
        hashed_pass = hash_ob.hexdigest()
        if hashed_pass == hashed_value:
            print('Found cleartext password! ' + line.strip())
            password_found = True
            break  # Exit the loop when password is found

if not password_found:
    print(hash_input.strip()+" is not the Password or Password not found in the wordlist.")
