from scapy.all import *

def arp_scan(interface, ip_range, timeout=2, inter=0.1):
    try:
        # Craft ARP request packet
        packet = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=ip_range)

        # Send and receive packets
        ans, _ = srp(packet, timeout=timeout, iface=interface, inter=inter)

        # Print results
        for send, receive in ans:
            print(f"MAC: {receive[Ether].src} - IP: {receive[ARP].psrc}")

    except Exception as e:
        print(f"An error occurred: {e}")

def main():
    # Ask user for the interface name, Check using "IPconfig/ifconfig" in CMD/terminal in Windows/Linux
    interface = input("Enter the interface name (e.g., 'Wi-Fi, Ethernet', They are Case Sensetive): ").strip()

    # Ask user for the IP range
    ip_range = input("Enter the IP range (e.g., '192.168.1.2/24'): ").strip()

    print(f"Scanning IP range: {ip_range} on interface: {interface}")
    arp_scan(interface, ip_range)

if __name__ == "__main__":
    main()
